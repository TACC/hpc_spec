Mon Oct 26 00:06:05 CDT 2015
================================================================================
================================================================================
================================================================================
VERBOSE set to 0
================================================================================
================================================================================
================================================================================
================================================================================
Test 1: P L 1 M L 2 D: Should PASS
	package Bar-package-1.1-1.x86_64 is already installed
	package Bar-modulefile-1.1-1.x86_64 is already installed
================================================================================
Test 2: P L 2 M L 1 D: Should PASS
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 3: P S 1 M L 2 D: Should PASS with entry in ${sharpm}
================================================================================
Test 4: P S 1 M L 2 D: Should FAIL because of wrong install order
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[1;31mWARNING: Entry "Bar-package-1.1-1" does not exist in /home1/03078/cproctor/rpmtest/sharerpm_config when it should.[0m
================================================================================
Test 5: P L 1 M S 2 D: Should PASS -- no warning but unusual case
================================================================================
Test 6: P L 2 M S 1 D: Should PASS -- warning for unusual case
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 7: P S 1 M S 2 D: Should PASS
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
================================================================================
Test 8: P S 2 M S 1 D: Should PASS
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 9: P L 1 M L 2 D R: Should PASS
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 10: P L 2 M L 1 D R: Should PASS
================================================================================
Test 11: P S 1 M L 2 D R: Should PASS with entry in ${sharpm}
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
================================================================================
Test 12: P S 1 M L 2 D R: Should FAIL because of wrong install order
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 13: P L 1 M S 2 D R: Should PASS -- no warning but unusual case
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 14: P L 2 M S 1 D R: Should PASS -- warning for unusual case
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
================================================================================
Test 15: P S 1 M S 2 D R: Should PASS
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
================================================================================
Test 16: P S 2 M S 1 D R: Should PASS
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
================================================================================
Test 17: P L 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 18: P L 2 M L 1 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 19: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 20: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 21: P L 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 22: P L 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 23: P S 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 24: P S 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 25: P L 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 26: P L 2 M L 1 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 27: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 28: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 29: P L 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 30: P L 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 31: P S 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 32: P S 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
================================================================================
Test 33: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is not set -- can't find TACC canary files
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
Test 34: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is set but rpms don't use dbpath flag -- can't find TACC canary files
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
================================================================================
Test 35: P L 1 M L 2 N: Should FAIL because rpm dependencies cannot be met; add --nodeps flag.
error: Failed dependencies:
	/bin/sh is needed by Bar-package-1.1-1.x86_64
error: Failed dependencies:
	/bin/sh is needed by Bar-modulefile-1.1-1.x86_64
error: package Bar-package-1.1-1.x86_64 is not installed
error: package Bar-modulefile-1.1-1.x86_64 is not installed
================================================================================
Test 36: P L 1 M L 2 D: Should FAIL because relocate commands are mixed up.
[1;31mERROR: $POST_INSTALL_PREFIX matches temporary install prefix /tmprpm![0m
[1;31mERROR: Use the --relocate /tmprpm=/some/real/path[0m
[1;31mERROR: $POST_MODULE_PREFIX matches temporary module prefix /tmpmod![0m
[1;31mERROR: Use the --relocate /tmpmod=/some/real/path[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 253
================================================================================
Test 37: P L 1 M L 2 D: Should PASS -- simultaneous install is okay.
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
================================================================================
================================================================================
================================================================================
VERBOSE set to 1
================================================================================
================================================================================
================================================================================
================================================================================
Test 1: P L 1 M L 2 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: opt
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 2: P L 2 M L 1 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: opt
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 3: P S 1 M L 2 D: Should PASS with entry in ${sharpm}
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
"Bar-package-1.1-1" was installed in shared space.
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 4: P S 1 M L 2 D: Should FAIL because of wrong install order
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
"Bar-package-1.1-1" was installed in shared space.
[1;31mWARNING: Entry "Bar-package-1.1-1" does not exist in /home1/03078/cproctor/rpmtest/sharerpm_config when it should.[0m
================================================================================
Test 5: P L 1 M S 2 D: Should PASS -- no warning but unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: scratch
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 6: P L 2 M S 1 D: Should PASS -- warning for unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: scratch
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 7: P S 1 M S 2 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: scratch
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 8: P S 2 M S 1 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 9: P L 1 M L 2 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 10: P L 2 M L 1 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: opt
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: opt
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 11: P S 1 M L 2 D R: Should PASS with entry in ${sharpm}
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 12: P S 1 M L 2 D R: Should FAIL because of wrong install order
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 13: P L 1 M S 2 D R: Should PASS -- no warning but unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 14: P L 2 M S 1 D R: Should PASS -- warning for unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: scratch
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: scratch
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 15: P S 1 M S 2 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 16: P S 2 M S 1 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: scratch
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 17: P L 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 18: P L 2 M L 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 19: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 20: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 21: P L 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 22: P L 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 23: P S 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 24: P S 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 25: P L 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 26: P L 2 M L 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 27: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 28: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 29: P L 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 30: P L 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 31: P S 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 32: P S 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 33: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is not set -- can't find TACC canary files
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: 
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 34: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is set but rpms don't use dbpath flag -- can't find TACC canary files
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 35: P L 1 M L 2 N: Should FAIL because rpm dependencies cannot be met; add --nodeps flag.
error: Failed dependencies:
	/bin/sh is needed by Bar-package-1.1-1.x86_64
error: Failed dependencies:
	/bin/sh is needed by Bar-modulefile-1.1-1.x86_64
error: package Bar-package-1.1-1.x86_64 is not installed
error: package Bar-modulefile-1.1-1.x86_64 is not installed
================================================================================
Test 36: P L 1 M L 2 D: Should FAIL because relocate commands are mixed up.
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /tmprpm 
rpm package install location:                                /tmprpm/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: tmprpm
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /tmprpm 
rpm package install location:                                /tmprpm/Bar/1.1
rpm post-install module prefix:                              /tmpmod  
rpm modulefile install location:                             /tmpmod/modulefiles/Bar  
[1;31mERROR: $POST_INSTALL_PREFIX matches temporary install prefix /tmprpm![0m
[1;31mERROR: Use the --relocate /tmprpm=/some/real/path[0m
[1;31mERROR: $POST_MODULE_PREFIX matches temporary module prefix /tmpmod![0m
[1;31mERROR: Use the --relocate /tmpmod=/some/real/path[0m
Replacing "/tmprpm" with "/tmprpm" in modulefile       
Replacing "/tmpmod" with "/tmpmod" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/tmprpm[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/tmpmod[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 253
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: tmprpm
POST_MODULEFILE_INSTALL_ROOT: tmpmod
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 37: P L 1 M L 2 D: Should PASS -- simultaneous install is okay.
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: opt
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
POST_MODULEFILE_INSTALL_ROOT: 
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
================================================================================
================================================================================
VERBOSE set to 2
================================================================================
================================================================================
================================================================================
================================================================================
Test 1: P L 1 M L 2 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
V1: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V1: POST_PACKAGE_INSTALL_ROOT: opt is not work
V1: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V1: POST_PACKAGE_INSTALL_ROOT: opt is not share
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: opt
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not work
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 2: P L 2 M L 1 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
V3: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V3: POST_PACKAGE_INSTALL_ROOT: opt is not work
V3: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V3: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: opt
V4: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V4: POST_MODULEFILE_INSTALL_ROOT:  is not work
V4: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V4: POST_MODULEFILE_INSTALL_ROOT:  is not share
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 3: P S 1 M L 2 D: Should PASS with entry in ${sharpm}
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not work
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not share
"Bar-package-1.1-1" was installed in shared space.
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 4: P S 1 M L 2 D: Should FAIL because of wrong install order
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
V2: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V2: POST_MODULEFILE_INSTALL_ROOT:  is not work
V2: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V2: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not work
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not share
"Bar-package-1.1-1" was installed in shared space.
[1;31mWARNING: Entry "Bar-package-1.1-1" does not exist in /home1/03078/cproctor/rpmtest/sharerpm_config when it should.[0m
================================================================================
Test 5: P L 1 M S 2 D: Should PASS -- no warning but unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
V1: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V1: POST_PACKAGE_INSTALL_ROOT: opt is not work
V1: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V1: POST_PACKAGE_INSTALL_ROOT: opt is not share
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: scratch
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not work
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 6: P L 2 M S 1 D: Should PASS -- warning for unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
V3: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V3: POST_PACKAGE_INSTALL_ROOT: opt is not work
V3: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V3: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: scratch
V4: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V4: POST_MODULEFILE_INSTALL_ROOT:  is not work
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 7: P S 1 M S 2 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not work
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: scratch
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 8: P S 2 M S 1 D: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
V2: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V2: POST_MODULEFILE_INSTALL_ROOT:  is not work
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 9: P L 1 M L 2 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
V1: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V1: POST_PACKAGE_INSTALL_ROOT: opt is not work
V1: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V1: POST_PACKAGE_INSTALL_ROOT: opt is not share
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 10: P L 2 M L 1 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
V3: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V3: POST_PACKAGE_INSTALL_ROOT: opt is not work
V3: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V3: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: opt
V4: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V4: POST_MODULEFILE_INSTALL_ROOT:  is not work
V4: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V4: POST_MODULEFILE_INSTALL_ROOT:  is not share
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: opt
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not work
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT: opt is not share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 11: P S 1 M L 2 D R: Should PASS with entry in ${sharpm}
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 12: P S 1 M L 2 D R: Should FAIL because of wrong install order
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: opt
V2: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V2: POST_MODULEFILE_INSTALL_ROOT:  is not work
V2: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V2: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;31mERROR: modulefile rpm is installed in local space[0m
[1;31mERROR: package rpm is currently being installed shared space[0m
[1;31mERROR: under master/compute rpm db model, this installation order should not happen![0m
[1;31mERROR: package rpm should be installed on master first and then modulefile rpm on computes![0m
[1;31mERROR: Bailing out![0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 13: P L 1 M S 2 D R: Should PASS -- no warning but unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: opt
V1: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V1: POST_PACKAGE_INSTALL_ROOT: opt is not work
V1: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V1: POST_PACKAGE_INSTALL_ROOT: opt is not share
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 14: P L 2 M S 1 D R: Should PASS -- warning for unusual case
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
V3: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V3: POST_PACKAGE_INSTALL_ROOT: opt is not work
V3: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V3: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: scratch
V4: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V4: POST_MODULEFILE_INSTALL_ROOT:  is not work
[1;31mWARN: modulefile rpm is found in shared space[0m
[1;31mWARN: package rpm is in local space[0m
[1;31mWARN: for Lmod performance, both should be in local space[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: scratch
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not work
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 15: P S 1 M S 2 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: scratch
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V1: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
Entry for Package RPM Bar-package-1.1-1 has successfully been added to /home1/03078/cproctor/rpmtest/sharerpm_config
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in shared space.
[1;32mWARNING: Entry "Bar-package-1.1-1" exists in /home1/03078/cproctor/rpmtest/sharerpm_config.[0m
[1;32mWARNING: $PACKAGE_SHARE: 1, $MODULE_SHARE: 1[0m
Removed Bar-package-1.1-1 from /home1/03078/cproctor/rpmtest/sharerpm_config
================================================================================
Test 16: P S 2 M S 1 D R: Should PASS
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: scratch
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V3: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 is being installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
V2: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V2: POST_MODULEFILE_INSTALL_ROOT:  is not work
[1;31mWARNING: Both package and modulefile are being installed in shared space[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: scratch
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not home1
V5: POST_PACKAGE_INSTALL_ROOT: scratch is not work
Package RPM Bar-package-1.1-1 was installed in shared space: scratch
POST_MODULEFILE_INSTALL_ROOT: scratch
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: scratch is not work
Modulefile RPM Bar-modulefile-1.1-1 was installed in shared space: scratch
"Bar-package-1.1-1" was installed in shared space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 17: P L 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 18: P L 2 M L 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 19: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 20: P S 1 M L 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 21: P L 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 22: P L 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 23: P S 1 M S 2 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 24: P S 2 M S 1 N: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 25: P L 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 26: P L 2 M L 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 27: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 28: P S 1 M L 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/scratch/03078/cproctor/rpmtest[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/opt/apps[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 29: P L 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 30: P L 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/opt/apps[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/scratch/03078/cproctor/rpmtest[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 31: P S 1 M S 2 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mWARN: Package RPM is being installed using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 32: P S 2 M S 1 N R: Should PASS with warn about non-standard RPM db location
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /scratch/03078/cproctor/rpmtest 
rpm package install location:                                /scratch/03078/cproctor/rpmtest/Bar/1.1
rpm post-install module prefix:                              /scratch/03078/cproctor/rpmtest  
rpm modulefile install location:                             /scratch/03078/cproctor/rpmtest/modulefiles/Bar  
[1;31mWARN: Modulefile RPM was installed while using non-standard RPM database location.[0m
[1;31mWARN: Package RPM is being installed while using non-standard RPM database location.[0m
[1;31mWARN: You're off the map! Good luck, friend.[0m
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
Replacing "/tmprpm" with "/scratch/03078/cproctor/rpmtest" in modulefile       
Replacing "/tmpmod" with "/scratch/03078/cproctor/rpmtest" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/scratch/03078/cproctor/rpmtest[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
================================================================================
Test 33: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is not set -- can't find TACC canary files
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: 
V5: POST_PACKAGE_INSTALL_ROOT:  is not home1
V5: POST_PACKAGE_INSTALL_ROOT:  is not work
V5: POST_PACKAGE_INSTALL_ROOT:  is not scratch
V5: POST_PACKAGE_INSTALL_ROOT:  is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 34: P L 1 M L 2 N: Should FAIL because RPM_DBPATH is set but rpms don't use dbpath flag -- can't find TACC canary files
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;31mERROR: POST_INSTALL_PREFIX is currently set but null or unset
[1;31mERROR: tacc_install_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-package-1.1-1 <options>"[0m
warning: %post(Bar-package-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
[1;31mERROR: POST_MODULE_PREFIX is currently set but null or unset
[1;31mERROR: tacc_module_canary was not found
[1;31mERROR: Something is not right. Exiting![0m
[1;31mReinstall with environment variable VERBOSE=1 for more detailed information[0m
[1;31mYou must uninstall this package with "rpm -e Bar-modulefile-1.1-1 <options>"[0m
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 255
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using user-specified RPM database path:                      /home1/03078/cproctor/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
================================================================================
Test 35: P L 1 M L 2 N: Should FAIL because rpm dependencies cannot be met; add --nodeps flag.
error: Failed dependencies:
	/bin/sh is needed by Bar-package-1.1-1.x86_64
error: Failed dependencies:
	/bin/sh is needed by Bar-modulefile-1.1-1.x86_64
error: package Bar-package-1.1-1.x86_64 is not installed
error: package Bar-modulefile-1.1-1.x86_64 is not installed
================================================================================
Test 36: P L 1 M L 2 D: Should FAIL because relocate commands are mixed up.
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /tmprpm 
rpm package install location:                                /tmprpm/Bar/1.1
[1;32mPOST_MODULE_PREFIX set but null or unset[0m
[1;32mHas Bar-modulefile-1.1-1 been installed in this rpm database yet?[0m
[1;32mInstall Bar-modulefile-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
POST_PACKAGE_INSTALL_ROOT: tmprpm
V1: POST_PACKAGE_INSTALL_ROOT: tmprpm is not home1
V1: POST_PACKAGE_INSTALL_ROOT: tmprpm is not work
V1: POST_PACKAGE_INSTALL_ROOT: tmprpm is not scratch
V1: POST_PACKAGE_INSTALL_ROOT: tmprpm is not share
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /tmprpm 
rpm package install location:                                /tmprpm/Bar/1.1
rpm post-install module prefix:                              /tmpmod  
rpm modulefile install location:                             /tmpmod/modulefiles/Bar  
[1;31mERROR: $POST_INSTALL_PREFIX matches temporary install prefix /tmprpm![0m
[1;31mERROR: Use the --relocate /tmprpm=/some/real/path[0m
[1;31mERROR: $POST_MODULE_PREFIX matches temporary module prefix /tmpmod![0m
[1;31mERROR: Use the --relocate /tmpmod=/some/real/path[0m
Replacing "/tmprpm" with "/tmprpm" in modulefile       
Replacing "/tmpmod" with "/tmpmod" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K/tmprpm[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;92m[K/tmpmod[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
warning: %post(Bar-modulefile-1.1-1.x86_64) scriptlet failed, exit status 253
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: tmprpm
V5: POST_PACKAGE_INSTALL_ROOT: tmprpm is not home1
V5: POST_PACKAGE_INSTALL_ROOT: tmprpm is not work
V5: POST_PACKAGE_INSTALL_ROOT: tmprpm is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: tmprpm is not share
POST_MODULEFILE_INSTALL_ROOT: tmpmod
V6: POST_MODULEFILE_INSTALL_ROOT: tmpmod is not home1
V6: POST_MODULEFILE_INSTALL_ROOT: tmpmod is not work
V6: POST_MODULEFILE_INSTALL_ROOT: tmpmod is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT: tmpmod is not share
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
================================================================================
Test 37: P L 1 M L 2 D: Should PASS -- simultaneous install is okay.
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-modulefile-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
No entry for Bar-package-1.1-1 found in /home1/03078/cproctor/rpmtest/sharerpm_config
[1;32mPOST_INSTALL_PREFIX is set but null or unset[0m
[1;32mHas Bar-package-1.1-1 been installed in this rpm database yet?[0m
[1;32mHas Bar-package-1.1-1 been installed in master's rpm database yet?[0m
[1;32mInstall Bar-package-1.1-1 to automatically update modulefiles/Bar/1.1.lua[0m
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage postinstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
rpm post-install install prefix:                             /opt/apps 
rpm package install location:                                /opt/apps/Bar/1.1
rpm post-install module prefix:                              /opt/apps  
rpm modulefile install location:                             /opt/apps/modulefiles/Bar  
POST_PACKAGE_INSTALL_ROOT: opt
V3: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V3: POST_PACKAGE_INSTALL_ROOT: opt is not work
V3: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V3: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: opt
V4: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V4: POST_MODULEFILE_INSTALL_ROOT:  is not work
V4: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V4: POST_MODULEFILE_INSTALL_ROOT:  is not share
Replacing "/tmprpm" with "/opt/apps" in modulefile       
Replacing "/tmpmod" with "/opt/apps" in modulefile         
--------------------------------------------------------------------------------
local help_msg=[[
The BAR module defines the following environment variables:
TACC_BAR_DIR, TACC_BAR_LIB, TACC_BAR_INC and
TACC_BAR_BIN for the location of the BAR distribution, libraries,
include files, and tools respectively.
]]

--help(help_msg)
help(help_msg)

whatis("Name: bar")
whatis("Version: 1.1")

-- Create environment variables.
local bar_dir           = "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/Bar/1.1"

family("bar")
prepend_path(    "PATH",                pathJoin(bar_dir, "bin"))
prepend_path(    "LD_LIBRARY_PATH",     pathJoin(bar_dir, "lib"))
prepend_path(    "MODULEPATH",         "[01;91m[K[01;92m[K/opt/apps[m[K[m[K/bar1_1/modulefiles")
setenv( "TACC_BAR_DIR",                bar_dir)
setenv( "TACC_BAR_INC",       pathJoin(bar_dir, "include"))
setenv( "TACC_BAR_LIB",       pathJoin(bar_dir, "lib"))
setenv( "TACC_BAR_BIN",       pathJoin(bar_dir, "bin"))
--------------------------------------------------------------------------------
[0m======================================================================[0m
[0m||[1;34m TTTTTTTTTTTTTTT     AAAAA      [0m    /@@@@@@@\        /@@@@@@@\    [0m||[0m
[0m||[1;34m TTTTTTTTTTTTTTT    /AAAAA\     [0m  @@@@@@@@@@@@\    @@@@@@@@@@@@\  [0m||[0m
[0m||[1;34m      TTTTT        /AA/[0mA[1;34m\AA\    [0m @@@@@/   \@@@@|  @@@@@/   \@@@@| [0m||[0m
[0m||[1;34m      TTTTT       /AA/[0mA@A[1;34m\AA\   [0m|@@@@/      '''' |@@@@/      '''' [0m||[0m
[0m||[1;34m      TTTTT      ,[0m^V@@@@@@@V^[1;34m,  [1;31m|CCCC            |CCCC            [0m||[0m
[0m||[1;34m      TTTTT      AAAV[0m@@@@@[1;34mVAAA  [1;31m CCCCC    ,CCCC|  CCCCC    ,CCCC| [0m||[0m
[0m||[1;34m      TTTTT     /AAV[0m|@/^\@|[1;34mVAA\ [1;31m  CCCCCCCCCCCCC    CCCCCCCCCCCCC  [0m||[0m
[0m||[1;34m      TTTTT    /AAA|[0m/     \[1;34m|AAA\[1;31m    ^CCCCCCC^        ^CCCCCCC^    [0m||[0m
[0m======================================================================[0m
This is the Bar-package-1.1-1 subpackage preuninstall script
Using default RPM database path:                             /var/lib/rpm
rpm build-time macro module prefix:                          /tmpmod       
rpm build-time macro install prefix:                         /tmprpm      
rpm build-time macro MODULE_DIR:                             /tmpmod/modulefiles/Bar          
rpm build-time macro INSTALL_DIR:                            /tmprpm/Bar/1.1         
POST_PACKAGE_INSTALL_ROOT: opt
V5: POST_PACKAGE_INSTALL_ROOT: opt is not home1
V5: POST_PACKAGE_INSTALL_ROOT: opt is not work
V5: POST_PACKAGE_INSTALL_ROOT: opt is not scratch
V5: POST_PACKAGE_INSTALL_ROOT: opt is not share
POST_MODULEFILE_INSTALL_ROOT: 
V6: POST_MODULEFILE_INSTALL_ROOT:  is not home1
V6: POST_MODULEFILE_INSTALL_ROOT:  is not work
V6: POST_MODULEFILE_INSTALL_ROOT:  is not scratch
V6: POST_MODULEFILE_INSTALL_ROOT:  is not share
[1;32m$POST_MODULE_PREFIX is not set. Is the Modulefile RPM already uninstalled?[0m
[1;32mSituation indeterminate. Delibrately setting $MODULE_SHARE to 1.[0m
"Bar-package-1.1-1" was installed in local space.
No entry found in /home1/03078/cproctor/rpmtest/sharerpm_config. All is right in the world. Good bye!
